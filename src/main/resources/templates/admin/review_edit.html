<!-- 【書評詳細】 -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${review.reviewTitle} + ' | 書評詳細'">データが取得できませんでした:書評名 | 書評詳細</title>
    <link rel="icon" th:href="@{/img/zoutohana-jitsubutsu.png}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="../../static/css/admin/admin-style.css" th:href="@{/css/admin/admin-style.css}">
</head>
<body id="projectEdit-page">
    <div th:replace="~{layout-admin :: header}"></div>

    <main id="admin-main">
      <a href="review_list.html" th:href="@{/admin/review/list(urlKey=${review.projectUrlKey})}" class="icon-center review-card-sub-info text-decoration-none hover-bold">
        <span class="material-symbols-outlined">keyboard_double_arrow_left</span>書評一覧に戻る
      </a>
      <h1 class="page-title">
        <span class="material-symbols-outlined scale-bigger text-gray mr-2">note_stack</span>
        書評詳細
      </h1>

      <div class="main-content">
        <div class="main-content-card p-8 mt-2"> <!-- 書評カード -->
          <div class="table-border-b-strong pb-4"> <!-- 書評カードヘッダー -->
            <p class="review-card-sub-info">No.<span th:text="${review.id}">0</span></p>
            <div class="flex justify-between">
              <h3 class="review-card-title" th:text="${review.reviewTitle}">データが取得できませんでした:書評名</h3>
              <h3 class="review-card-title" th:text="|${review.voteCount}票|">0票</h3> <!-- 右側 -->
            </div>
            <p class="review-card-sub-info ml-4" th:text="|企画名 : ${review.projectName}|"></p>
          </div>

          <div class="table-border-b-strong py-4"> <!-- 書評カードボディ(上)) -->
            <div> <!-- 右側 -->
              <table class="w-half">
                <tr>
                  <th>名前 : </th>
                  <td>
                    <a href="account_view.html" th:href="@{/admin/account/view(loginId=${review.userLoginId})}">
                      <span th:text="|${review.userNickname}(ID:${review.userLoginId})|">-----</span>
                    </a>
                  </td>
                </tr>
                <tr>
                  <th>居住地 : </th>
                  <td th:text="${review.userAddress}">-----</td>
                </tr>
                <tr>
                  <th>年代 : </th>
                  <td th:text="${review.userAgeGroup}">0</td>
                </tr>
                <tr>
                  <th>性別 : </th>
                  <td th:text="${review.userGender.label}"></td>
                </tr>
                </table>
                <p class="font-bold">自己紹介 : </p>
                <pre th:text="${review.userSelfIntroduction}">-----</pre>
              </div>
          </div>

          <div class="table-border-b-strong py-4"> <!-- 書評カードボディ(下) -->
            <div class="flex">
              <table class="pr-8 mb-auto w-quarter">
                <tr>
                  <th>ISBN : </th>
                  <td th:text="${review.bookIsbn}">-----</td>
                </tr>
                <tr>
                  <th>タイトル : </th>
                  <td th:text="${review.bookTitle}">-----</td>
                </tr>
                <tr>
                  <th>出版社 : </th>
                  <td th:text="${review.bookPublisher}">-----</td>
                </tr>
                <tr>
                  <th>著者 : </th>
                  <td th:text="${review.bookAuthor}">-----</td>
                </tr>
              </table>
              <div class="flex-1">
                <table>
                  <tr>
                    <th>書評ステータス : </th>
                    <td>
                      <form method="POST" th:action="@{/admin/review/statusUpdateSingle}" class="no-auto-submit flex gap-1">
                        <input type="hidden" name="reviewId" th:value="${review.id}">
                        <select class="select w-full flex-1" name="targetStatus">
                          <option value="INITIAL" th:selected="${review.status == 'INITIAL'}">一次審査未通過</option>
                          <option value="FIRST_STAGE_PASSED" th:selected="${review.status == 'FIRST_STAGE_PASSED'}">一次審査通過</option>
                          <option value="SECOND_STAGE_PASSED" th:selected="${review.status == 'SECOND_STAGE_PASSED'}">ノミネート</option>
                          <option value="AWARDED" th:selected="${review.status == 'AWARDED'}">大賞</option>
                        </select>
                        <button type="submit" class="btn">更新</button>
                      </form>
                    </td>
                  </tr>
                  <tr>
                    <th>書評タイトル : </th>
                    <td th:text="${review.reviewTitle}"></td>
                  </tr>
                </table>
                <p class="font-bold">本文 : </p>
                <pre th:text="${review.reviewContent}"></pre>
              </div>
            </div>
            <form th:action="@{/admin/review/genreUpdate}" method="post" class="flex gap-1 mt-4 items-start">
              <input type="hidden" name="reviewId" th:value="${review.id}">
              <div id="genre-hidden-area"></div>

              <span class="font-bold mt-2">書評のジャンル : </span>
              <div id="multi-select-wrap" class="w-full flex-1">
                <div id="multi-select-tags"></div>
                <input type="text" id="genre-input" class="input-text w-full">
                <div id="multi-select-options" hidden></div>
              </div>
              <button type="submit" class="btn">更新</button>
            </form>
          </div>

          <div class="flex justify-between pt-4"> <!-- 書評カードフッター -->
            <div> <!-- 左側 -->
              <p class="review-card-sub-info" th:text="'投稿日時 : ' + ${#temporals.format(review.createdAt, 'yyyy/MM/dd HH:mm')}">0000/00/00 00:00</p>
              <p class="review-card-sub-info" th:text="'更新日時 : ' + ${#temporals.format(review.updatedAt, 'yyyy/MM/dd HH:mm')}">0000/00/00 00:00</p>
            </div>
          </div>
        </div>

        <div class="btn-wrap mt-8">
          <button type="button" class="btn btn-danger" data-modal-target="delete-confirm-modal">削除する</button>
          <a href="notification.html" th:href="@{/admin/notification/send/} + ${review.id}" class="btn">個別通知を送る</a>
          <a href="review_print.html" th:href="@{/admin/review/print(id=${review.id})}" class="btn">情報をコピーする</a>
        </div>
      </div>
    </main>

    <div id="delete-confirm-modal" class="modal">
      <div>
        <div class="modal-content">
          <h2 class="page-title mx-auto">注意</h2>
          <span class="modal-close"><span class="material-symbols-outlined">close</span></span>

          <div class="mt-8">
            <p>本当にこの書評を削除しますか？</span></p>
            <p><span class="font-bold underline text-danger">削除したデータは復元できません。</span></p>
            <p class="mt-4">削除を実行するには、以下の入力欄に投稿者のIDを入力してください。</p>
          </div>

          <div class="mt-8">
            <p>投稿者ID : <span th:text="${review.userLoginId}"></span></p>
            <form th:action="@{/admin/review/delete}" method="post">
              <input type="hidden" name="urlKey" th:value="${review.projectUrlKey}">
              <input type="hidden" name="reviewId" th:value="${review.id}">
              <input type="text" name="inputUserLoginId" class="input-text w-full" th:placeholder="${review.userLoginId}">
              <div class="btn-wrap mt-8">
                <button type="submit" class="btn btn-danger">削除する</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script th:inline="javascript">
      window.optionsList = [[${genreOptions}]];
      window.initialGenres = [[${thisReviewGenres}]];
    </script>
    <script th:src="@{/js/admin/admin-general.js}"></script>
    <script th:src="@{/js/admin/review-edit.js}"></script>
</body>
</html>
