<!-- 【お知らせ一覧】 -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お知らせ一覧</title>
    <link rel="icon" th:href="@{/img/zoutohana-jitsubutsu.png}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="../../static/css/admin/admin-style.css" th:href="@{/css/admin/admin-style.css}">
</head>
<body>
    <div th:replace="~{layout-admin :: header}"></div>

    <main id="admin-main">
      <h1 class="page-title">
        <span class="material-symbols-outlined scale-bigger text-gray mr-2">docs</span>
        お知らせ一覧
        <span class="page-title-count" th:text="'(' + ${posts.size()} + '件)'">(0件)</span>
      </h1>

      <div class="main-content">
        <div class="flex justify-between mt-2"> <!-- テーブルの上のメニュー部分 -->
            <div class="flex gap-1"> <!-- メニュー左部分(並び替え) -->
                <form method="GET" th:action="@{/admin/post/list}">
                    <input type="hidden" name="keyword" th:value="${form.keyword}">
                    <th:block th:each="s : ${form.status}">
                        <input type="hidden" name="status" th:value="${s}">
                    </th:block>
                    <th:block th:each="c : ${form.category}">
                        <input type="hidden" name="category" th:value="${c}">
                    </th:block>
                    <input type="hidden" name="createdStartAt" th:value="${form.createdStartAt}">
                    <input type="hidden" name="createdEndAt" th:value="${form.createdEndAt}">
                    <input type="hidden" name="postedStartAt" th:value="${form.postedStartAt}">
                    <input type="hidden" name="postedEndAt" th:value="${form.postedEndAt}">

                    <select name="sort" class="select">
                        <option value="createdAt_desc" th:selected="${form.sort == 'createdAt_desc'}">作成日時(今→昔)</option>
                        <option value="createdAt_asc"  th:selected="${form.sort == 'createdAt_asc'}">作成日時(昔→今)</option>
                        <option value="postedAt_desc" th:selected="${form.sort == 'postedAt_desc'}">投稿日時(今→昔)</option>
                        <option value="postedAt_asc" th:selected="${form.sort == 'postedAt_asc'}">投稿日時(昔→今)</option>
                        <option value="title_asc" th:selected="${form.sort == 'title_asc'}">タイトル(昇順)</option>
                        <option value="title_desc" th:selected="${form.sort == 'title_desc'}">タイトル(降順)</option>
                    </select>
                </form>
                順
            </div>
          <div class="flex gap-1"> <!-- メニュー右部分(絞り込み・検索) -->
            <div class="filter-btn-container">
                <button type="button" class="btn filter-btn-wrap" id="filter-btn" data-modal-target="filter-option-modal">
                    絞り込みオプション
                </button>
                <a th:href="@{/admin/post/list(keyword=${form.keyword}, sort=${form.sort})}"
                    class="clear-filter-icon material-symbols-outlined"
                    onclick="event.stopPropagation();">
                    <span class="material-symbols-outlined">close</span>
                </a>
            </div>
            <form method="GET" th:action="@{/admin/post/list}" class="flex gap-1">
              <input type="hidden" name="sort" th:value="${form.sort}">
              <th:block th:each="s : ${form.status}">
                  <input type="hidden" name="status" th:value="${s}">
              </th:block>
              <th:block th:each="c : ${form.category}">
                  <input type="hidden" name="category" th:value="${c}">
              </th:block>
              <input type="hidden" name="createdStartAt" th:value="${form.createdStartAt}">
              <input type="hidden" name="createdEndAt" th:value="${form.createdEndAt}">
              <input type="hidden" name="postedStartAt" th:value="${form.postedStartAt}">
              <input type="hidden" name="postedEndAt" th:value="${form.postedEndAt}">

              <input type="search" name="keyword" class="input-text" placeholder="タイトルで検索" th:value="${form.keyword}">
              <button type="submit" class="btn"><span class="material-symbols-outlined scale-bigger">search</span></button>
              <a href="post_create.html" th:href="@{/admin/post/create}" class="btn">
                <span class="material-symbols-outlined scale-bigger pr-1">library_add</span>
                新しいお知らせを作成
              </a>
            </form>
          </div>
        </div>

        <table class="list-table mt-4">
          <tr>
            <th class="table-border-r">ステータス</th>
            <th>カテゴリー</th>
            <th class="table-border-r">タイトル</th>
            <th>作成日時</th>
            <th>表示される投稿日時</th>
            <th></th>
          </tr>
          <tr th:if="${#lists.isEmpty(posts)}">
              <td colspan="6" class="text-center">
                  該当するお知らせはありませんでした
              </td>
          </tr>
          <tr class="table-content-tr" th:each="post : ${posts}">
            <td class="table-border-r text-center">
              <span th:if="${post.status.label == '公開'}" class="status-blue">
                <span class="material-symbols-outlined">visibility</span>公開
              </span>
              <span th:if="${post.status.label == '非公開'}" class="status-red">
                <span class="material-symbols-outlined">visibility_off</span>非公開
              </span>
              <span th:if="${post.status.label == '下書き'}" class="status-gray">
                <span class="material-symbols-outlined">draft</span>下書き
              </span>
            </td>
            <td class="text-center">
              <span th:if="${post.category.label == '寄贈情報'}">寄贈</span>
              <span th:if="${post.category.label == '企画情報'}">企画</span>
              <span th:if="${post.category.label == 'その他情報'}">その他</span>
            </td>
            <td th:text="${post.title}" class="table-border-r">お知らせが読み込めませんでした</td>
            <td th:text="${#temporals.format(post.createdAt, 'yyyy/MM/dd HH:mm')}" class="text-center">0000/00/00 00:00</td>
            <td th:text="${#temporals.format(post.postedAt, 'yyyy/MM/dd HH:mm')}" class="text-center">0000/00/00 00:00</td>
            <td class="text-center">
                <a href="post_edit.html" th:href="@{/admin/post/view(id=${post.id})}" class="table-row-link">
                    <span class="material-symbols-outlined">keyboard_double_arrow_right</span>
                </a>
            </td>
          </tr>
        </table>
      </div>
    </main>

    <div id="filter-option-modal" class="modal">
      <div>
        <div class="modal-content">
          <h2 class="page-title-sub">絞り込みオプション</h2>
          <span class="modal-close"><span class="material-symbols-outlined">close</span></span>

          <form method="GET" th:action="@{/admin/post/list}">
            <input type="hidden" name="keyword" th:value="${form.keyword}">
            <input type="hidden" name="sort" th:value="${form.sort}">

            <ul class="modal-option-wrap mt-4 ml-4">
              <li>
                <label><input type="checkbox" class="modal-checkbox-parent">ステータス</label>
                <ul class="modal-checkbox-child grid-3">
                  <li><label><input type="checkbox" name="status" value="公開" th:checked="${form.status != null and form.status.contains('公開')}">公開</label></li>
                  <li><label><input type="checkbox" name="status" value="非公開" th:checked="${form.status != null and form.status.contains('非公開')}">非公開</label></li>
                  <li><label><input type="checkbox" name="status" value="下書き" th:checked="${form.status != null and form.status.contains('下書き')}">下書き</label></li>
                </ul>
              </li>
              <li>
                <label><input type="checkbox" class="modal-checkbox-parent">カテゴリー</label>
                <ul class="modal-checkbox-child grid-3">
                  <li><label><input type="checkbox" name="category" value="寄贈情報" th:checked="${form.category != null and form.category.contains('寄贈情報')}">寄贈情報</label></li>
                  <li><label><input type="checkbox" name="category" value="企画情報" th:checked="${form.category != null and form.category.contains('企画情報')}">企画情報</label></li>
                  <li><label><input type="checkbox" name="category" value="その他情報" th:checked="${form.category != null and form.category.contains('その他情報')}">その他情報</label></li>
                </ul>
              </li>
              <li>
                <label>
                  <input type="checkbox"
                        class="modal-checkbox-parent period-check"
                        data-start="createdStartAt"
                        data-end="createdEndAt"
                        th:checked="${form.createdStartAt != null and form.createdEndAt != null}">
                  作成日時
                </label>
                <div class="w-full ml-6">
                  <input type="datetime-local"
                        name="createdStartAt"
                        th:value="${form.createdStartAt}"
                        id="createdStartAt"
                        class="input-datetime">
                  ~
                  <input type="datetime-local"
                        name="createdEndAt"
                        th:value="${form.createdEndAt}"
                        id="createdEndAt"
                        class="input-datetime">
                </div>
              </li>

              <li>
                <label>
                  <input type="checkbox"
                        class="modal-checkbox-parent period-check"
                        data-start="postedStartAt"
                        data-end="postedEndAt"
                        th:checked="${form.postedStartAt != null and form.postedEndAt != null}">
                  表示される投稿日時
                </label>
                <div class="w-full ml-6">
                  <input type="datetime-local"
                        name="postedStartAt"
                        th:value="${form.postedStartAt}"
                        id="postedStartAt"
                        class="input-datetime">
                  ~
                  <input type="datetime-local"
                        name="postedEndAt"
                        th:value="${form.postedEndAt}"
                        id="postedEndAt"
                        class="input-datetime">
                </div>
              </li>
            </ul>

            <div class="btn-wrap mt-8">
                <button id="clear-all-checkbox" class="btn btn-danger">リセット</button>
                <button type="submit" class="btn">絞り込む</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="../../static/js/admin/admin-general.js" th:src="@{/js/admin/admin-general.js}"></script>
</body>
</html>
